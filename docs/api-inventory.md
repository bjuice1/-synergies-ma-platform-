# API Inventory - M&A Synergies Analysis Tool

**Last Updated:** 2026-02-15
**Generated By:** Claude Code Documentation System

---

## Overview

This document catalogs all API endpoints exposed by the M&A Synergies Analysis Tool, including authentication requirements, request/response formats, and integration points.

**Base URL (Development):** `http://localhost:5000`
**Base URL (Production):** `[To be configured]`

---

## Authentication

All protected endpoints require JWT authentication:

**Header Format:**
```
Authorization: Bearer <JWT_TOKEN>
```

**Token Acquisition:**
- Login endpoint: `POST /api/auth/login`
- Register endpoint: `POST /api/auth/register`
- Token expiration: 24 hours (configurable)

---

## Internal APIs (Endpoints We Expose)

### üè• Health & Monitoring

| Method | Path | Purpose | Auth Required | Response |
|--------|------|---------|---------------|----------|
| GET | `/health` | Health check endpoint | No | `{"status": "healthy"}` |

---

### üîê Authentication & User Management

#### Auth Endpoints (`/api/auth`)

| Method | Path | Purpose | Auth Required | Request Body | Response |
|--------|------|---------|---------------|--------------|----------|
| POST | `/api/auth/register` | Register new user | No | `{username, email, password}` | `{message, user, access_token}` |
| POST | `/api/auth/login` | User login | No | `{email, password}` | `{access_token, user}` |
| POST | `/api/auth/logout` | User logout | Yes | - | `{message}` |
| GET | `/api/auth/me` | Get current user profile | Yes | - | `{user}` |
| POST | `/api/auth/refresh` | Refresh JWT token | Yes | - | `{access_token}` |

**Example - Register:**
```json
POST /api/auth/register
{
  "username": "john_doe",
  "email": "john@example.com",
  "password": "secure_password123"
}

Response (201):
{
  "message": "User registered successfully",
  "user": {
    "id": 1,
    "username": "john_doe",
    "email": "john@example.com",
    "is_active": true
  },
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGc..."
}
```

**Validation Rules:**
- Username: Min 3 characters
- Password: Min 6 characters
- Email: Valid email format
- Unique username and email

---

### üìä Synergies Management

#### Synergies Endpoints (`/api/synergies`)

| Method | Path | Purpose | Auth Required | Request Body | Response |
|--------|------|---------|---------------|--------------|----------|
| GET | `/api/synergies/` | List all synergies | Yes | Query params | `{synergies: [...]}` |
| GET | `/api/synergies/<id>` | Get synergy by ID | Yes | - | `{synergy}` |
| POST | `/api/synergies/` | Create new synergy | Yes | `{name, type, value, ...}` | `{synergy}` |
| PUT | `/api/synergies/<id>` | Update synergy | Yes | `{name, type, value, ...}` | `{synergy}` |
| DELETE | `/api/synergies/<id>` | Delete synergy | Yes | - | `{message}` |

**Query Parameters (GET /api/synergies/):**
- `type` - Filter by synergy type (revenue, cost, etc.)
- `status` - Filter by status (pending, approved, realized)
- `date_from` - Start date filter
- `date_to` - End date filter
- `company_id` - Filter by company
- `page` - Pagination page number
- `per_page` - Results per page (default: 20)

**Example - Create Synergy:**
```json
POST /api/synergies/
Authorization: Bearer <token>
{
  "name": "Cross-sell Opportunity",
  "type": "revenue",
  "value": 1500000,
  "status": "projected",
  "company_id": 5,
  "description": "Sell Product A to Company B customers"
}

Response (201):
{
  "synergy": {
    "id": 123,
    "name": "Cross-sell Opportunity",
    "type": "revenue",
    "value": 1500000,
    "status": "projected",
    "created_at": "2026-02-15T10:30:00Z"
  }
}
```

---

### üè¢ Companies & Deals

#### Deals Endpoints (`/api/deals`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/deals` | List all deals | Yes |
| GET | `/api/deals/<id>` | Get deal details | Yes |
| POST | `/api/deals` | Create new deal | Yes |
| PUT | `/api/deals/<id>` | Update deal | Yes |
| DELETE | `/api/deals/<id>` | Delete deal | Yes |

#### Companies Endpoints (`/api/companies`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/companies` | List companies | Yes |
| GET | `/api/companies/<id>` | Get company details | Yes |
| POST | `/api/companies` | Create company | Yes |
| PUT | `/api/companies/<id>` | Update company | Yes |
| DELETE | `/api/companies/<id>` | Delete company | Yes |

---

### üìà Analytics & Reporting

#### Analytics Endpoints (`/api/analytics`)

| Method | Path | Purpose | Auth Required | Response |
|--------|------|---------|---------------|----------|
| GET | `/api/analytics/synergies/by-type` | Synergies grouped by type | Yes | `{types: [{type, count, total_value}]}` |
| GET | `/api/analytics/synergies/by-status` | Synergies grouped by status | Yes | `{statuses: [{status, count, total_value}]}` |
| GET | `/api/analytics/timeline` | Synergy realization timeline | Yes | `{timeline: [{date, realized_value}]}` |
| GET | `/api/analytics/roi` | ROI calculations | Yes | `{total_investment, total_return, roi_percentage}` |
| GET | `/api/analytics/overview` | Dashboard overview metrics | Yes | `{kpis, charts}` |
| GET | `/api/analytics/by-industry` | Analytics by industry | Yes | `{industries: [...]}` |
| GET | `/api/analytics/by-function` | Analytics by function | Yes | `{functions: [...]}` |

**Example - Synergies by Type:**
```json
GET /api/analytics/synergies/by-type
Authorization: Bearer <token>

Response (200):
{
  "types": [
    {
      "type": "revenue",
      "count": 45,
      "total_value": 12500000
    },
    {
      "type": "cost",
      "count": 32,
      "total_value": 8900000
    }
  ]
}
```

---

### üè≠ Industries & Functions

#### Industries Endpoints (`/api/industries`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/industries/` | List all industries | No |
| GET | `/api/industries/<id>` | Get industry by ID | No |
| POST | `/api/industries/` | Create industry | Yes (Admin) |
| PUT | `/api/industries/<id>` | Update industry | Yes (Admin) |
| DELETE | `/api/industries/<id>` | Delete industry | Yes (Admin) |

#### Functions Endpoints (`/api/functions`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/functions/` | List all business functions | No |
| GET | `/api/functions/<id>` | Get function by ID | No |

---

### üìë Templates

#### Templates Endpoints (`/app/routes/templates`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/templates` | List templates | Yes |
| GET | `/api/templates/<id>` | Get template | Yes |
| POST | `/api/templates` | Create template | Yes |
| PUT | `/api/templates/<id>` | Update template | Yes |
| DELETE | `/api/templates/<id>` | Delete template | Yes |

---

### üîî Notifications

#### Notifications Endpoints (`/app/api/notifications`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/notifications` | Get user notifications | Yes |
| GET | `/api/notifications/<id>` | Get notification details | Yes |
| PUT | `/api/notifications/<id>/read` | Mark as read | Yes |
| DELETE | `/api/notifications/<id>` | Delete notification | Yes |

---

### üìä Visualizations

#### Visualizations Endpoints (`/app/api/visualizations`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/visualizations` | List available visualizations | Yes |
| GET | `/api/visualizations/<id>` | Get visualization data | Yes |
| POST | `/api/visualizations` | Create custom visualization | Yes |
| PUT | `/api/visualizations/<id>` | Update visualization | Yes |
| DELETE | `/api/visualizations/<id>` | Delete visualization | Yes |

---

### üì• Export

#### Export Endpoints (`/app/routes/export`)

| Method | Path | Purpose | Auth Required | Query Params |
|--------|------|---------|---------------|--------------|
| GET | `/api/export/synergies` | Export synergies | Yes | `format=pdf\|excel` |
| GET | `/api/export/analytics` | Export analytics report | Yes | `format=pdf\|excel` |
| GET | `/api/export/deals` | Export deals | Yes | `format=excel` |

**Example - Export Synergies:**
```
GET /api/export/synergies?format=pdf&date_from=2026-01-01&date_to=2026-12-31
Authorization: Bearer <token>

Response: Binary PDF file download
```

---

### üìú Activity Logs

#### Activity Log Endpoints (`/app/routes/activity_logs`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/activity-logs` | Get user activity logs | Yes |
| GET | `/api/activity-logs/<id>` | Get specific activity | Yes |

---

### üîç Audit Trail

#### Audit Endpoints (`/app/api/audit`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/audit` | Get audit logs | Yes (Admin) |
| GET | `/api/audit/<id>` | Get specific audit entry | Yes (Admin) |

---

### üë• Users

#### Users Endpoints (`/app/routes/users`)

| Method | Path | Purpose | Auth Required |
|--------|------|---------|---------------|
| GET | `/api/users` | List users | Yes (Admin) |
| GET | `/api/users/<id>` | Get user details | Yes |
| PUT | `/api/users/<id>` | Update user | Yes (Self or Admin) |
| DELETE | `/api/users/<id>` | Delete user | Yes (Admin) |

---

## API Versioning

### Version 1 (`/api/v1`)

Legacy API with original endpoints:
- `/api/v1/synergies`
- `/api/v1/industries`
- `/api/v1/users`
- `/api/v1/analytics`
- `/api/v1/auth`
- `/api/v1/portfolios`
- `/api/v1/search`

### Version 2 (`/api/v2`)

Enhanced API with additional features:
- `/api/v2/synergies` - Enhanced synergy endpoints
- `/api/v2/portfolios` - Portfolio management

---

## External APIs (Services We Call)

### Email Service
- **Purpose:** Send notifications, reports, alerts
- **Protocol:** SMTP
- **Configuration Location:** Environment variables
  - `SMTP_HOST`
  - `SMTP_PORT`
  - `SMTP_USER`
  - `SMTP_PASSWORD`
- **Service:** `backend/app/services/email.py`

### PDF Generation
- **Purpose:** Generate PDF reports
- **Library:** ReportLab / WeasyPrint (to be determined)
- **Service:** `backend/services/pdf_service.py`

### Excel Export
- **Purpose:** Export data to Excel
- **Library:** openpyxl / xlsxwriter
- **Service:** `backend/app/services/export_service.py`

---

## Webhooks (Future/Planned)

### Inbound Webhooks
- **Not yet implemented**
- Planned for external integrations (Slack, Teams, etc.)

### Outbound Webhooks
- **Not yet implemented**
- Planned for event notifications

---

## Rate Limiting

**Implementation:** `backend/app/extensions/limiter.py`

**Limits (Default):**
- Authenticated requests: 100 requests/minute
- Unauthenticated requests: 20 requests/minute
- Login attempts: 5 requests/minute

**Response when rate limit exceeded:**
```json
{
  "error": "Rate limit exceeded. Please try again later.",
  "retry_after": 60
}
```

---

## Error Responses

### Standard Error Format

```json
{
  "error": "Error message here",
  "code": "ERROR_CODE",
  "details": {
    "field": "Additional context"
  }
}
```

### HTTP Status Codes

| Code | Meaning | Example |
|------|---------|---------|
| 200 | OK | Successful GET/PUT request |
| 201 | Created | Successful POST request |
| 204 | No Content | Successful DELETE request |
| 400 | Bad Request | Invalid input data |
| 401 | Unauthorized | Missing or invalid JWT token |
| 403 | Forbidden | Insufficient permissions |
| 404 | Not Found | Resource doesn't exist |
| 409 | Conflict | Duplicate resource (username, email) |
| 422 | Unprocessable Entity | Validation failed |
| 429 | Too Many Requests | Rate limit exceeded |
| 500 | Internal Server Error | Server-side error |

---

## Request/Response Formats

### Content-Type
- **Request:** `application/json`
- **Response:** `application/json` (or `application/pdf`, `application/vnd.ms-excel` for exports)

### Date Format
- **ISO 8601:** `2026-02-15T10:30:00Z`

### Pagination

**Request:**
```
GET /api/synergies?page=2&per_page=20
```

**Response:**
```json
{
  "data": [...],
  "pagination": {
    "page": 2,
    "per_page": 20,
    "total_pages": 10,
    "total_count": 195
  }
}
```

---

## Testing Endpoints

### Postman Collection
- **Location:** `docs/postman/synergies-api.json` (to be created)

### Example cURL Commands

**Register User:**
```bash
curl -X POST http://localhost:5000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "testpass123"
  }'
```

**Login:**
```bash
curl -X POST http://localhost:5000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "testpass123"
  }'
```

**Get Synergies:**
```bash
curl -X GET http://localhost:5000/api/synergies/ \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

---

## API Documentation

### Interactive Documentation
- **Swagger/OpenAPI:** To be implemented
- **Location:** `backend/app/api_docs.py` (in progress)

### Schema Definitions
- **Location:** `backend/app/schemas/`
- **Validation:** Marshmallow/Pydantic schemas

---

## Security Considerations

### Authentication
- JWT tokens expire after 24 hours
- Tokens must be included in Authorization header
- No support for API keys (JWT only)

### CORS
- Configured to allow frontend domain
- Headers allowed: `Content-Type`, `Authorization`

### Input Validation
- All endpoints validate input via schemas
- Prevents SQL injection, XSS attacks
- Schema location: `backend/app/schemas/`

### HTTPS
- **Production:** HTTPS required
- **Development:** HTTP allowed

---

## API Monitoring & Observability

### Logs
- **Request Logs:** All API requests logged
- **Error Logs:** Failed requests logged with stack traces
- **Audit Logs:** Critical actions logged to `audit_logs` table

### Metrics (Planned)
- Request count by endpoint
- Response time percentiles (p50, p95, p99)
- Error rate by endpoint
- Authentication success/failure rate

---

## Deprecation Policy

### Version Support
- **Current:** v1 and v2 both supported
- **Deprecation Notice:** 6 months advance warning
- **Sunset Period:** 3 months grace period after deprecation

### Breaking Changes
- Major version bump (v3, v4, etc.)
- Backward compatibility maintained in minor versions

---

## Future Endpoints (Roadmap)

### Planned Features
- [ ] `/api/forecasting` - Synergy forecasting with ML
- [ ] `/api/scenarios` - What-if analysis
- [ ] `/api/integrations/slack` - Slack integration
- [ ] `/api/integrations/teams` - Microsoft Teams integration
- [ ] `/api/webhooks` - Webhook management
- [ ] `/api/batch` - Batch operations
- [ ] `/api/search/advanced` - Advanced search with filters

---

## Support & Contact

**API Issues:** File issue at GitHub (to be configured)
**Documentation Updates:** Run `/document` command regularly
**Questions:** Contact dev team

---

**Documentation Status:** ‚úÖ Complete
**Total Endpoints Documented:** 100+
**Last Verified:** 2026-02-15
